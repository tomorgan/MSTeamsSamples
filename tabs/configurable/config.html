<html>
<head>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/css/bootstrap.min.css" integrity="sha384-/Y6pD6FV/Vv2HJnA6t+vslU6fwYXjCFtcEpHbNJ0lyAFsXTsjBbfaDjzALeQsN6M" crossorigin="anonymous">
<title>thoughtstuff - configurable tab sample</title>
</head>

<body>
  <p class="lead">Microsoft Teams Code Sample: Configurable Tabs</p>

<p>This is the first page your user sees when they add your tab to their Teams channel. You can use it to introduce how your tab works, or gather information and settings and use it to personalise the content of the page.</p>

<p>To demonstrate this, enter your name below to see it used in the tab. To change this later, use the Settings link - which re-open this page.</p>
  
<form>
  Your Name: <input id="userName" type="text" name="yourName"></input>  
</form> 
  
<p>Once you're ready, call a line of JavaScript to indicate to Teams that you're happy to continue:<br/>
  <button class="btn btn-success" onclick="setOkToSave()">Do that now</button>
  <p>
<p>For more information about this code sample, read the associated blog post:</p>

<script src="https://statics.teams.microsoft.com/sdk/v1.0/js/MicrosoftTeams.min.js"></script>

<script type="text/javascript">  
  
 
microsoftTeams.initialize();
microsoftTeams.settings.registerOnSaveHandler(function(saveEvent){
  
   
       microsoftTeams.settings.setSettings({
         entityId: "configTab1",
         contentUrl: "https://tomorgan.github.io/MSTeamsSamples/tabs/configurable/config.html?name=" + document.getElementById('userName').value,
         suggestedDisplayName: "ThoughtStuff Configurable Tab Sample",
         websiteUrl: "https://thoughtstuff.co.uk",
         removeUrl: "https://tomorgan.github.io/MSTeamsSamples/tabs/configurable/remove.html",
      });
   

    saveEvent.notifySuccess();
});

function setOkToSave() {
     microsoftTeams.settings.setValidityState(true);
  return true;
}  
  </script>
  
</body>



</html>

